<!DOCTYPE html>
<html lang="en" style="font-size: 50px;">
<head>
    <title>测试</title>
    <meta charset="UTF-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"> </script>
</head>
<style>
    body{
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
    }

    .wrapper{
        width: 100%;
        margin: 0 auto;
        position: relative;
        overflow: hidden;
    }

    .bg{
        width: 100%;
        left: 0;
        top: 0;
        position: absolute;
    }

    .video{
        position: absolute;
        display: none;
        top: 0;
        left: 0;
    }

    .start{
        position: absolute;
        top: 0;
        left: 0;
        width: 0;
        height: 0;
    }
    .answer_one{
        position: absolute;
        width: 200px;
        height: 100px;
        border:2px dashed #FFFFFF;
    }
    .next{
        position: absolute;
        display: none;
        width: 0;
        height: 0;
    }
    
</style>
<body>

    <div class="wrapper" id="wrapper">
        <img  class="bg" src="image/blue_bg_with_mark.png"/>
        <video id="video"
               class="video"
               preload="preload"
               name="media"
               disablePictureInPicture
               x-webkit-airplay="deny"
               webkit-playsinline="true"
               playsinline="true"
               x5-video-player-type="h5">
            <source src="image/test_video.mp4" type="video/mp4">

        </video>
        <img class="start" id="start" onclick="startPlay()" src="image/sure.png"/>
        <img class="next" id="next" onclick="answerNext()" src="image/sure.png"/>
    </div>
       
</body>

<script type="text/javascript">

   var questionPausePoit = [153.778493,179.956628]
   var isPlay = false;
   var questionPauseIndex = -1;
   var questionAnswer = []

   window.onload = function(){
        this.resizeView()
        this.loadListener()
   }

   function resizeView(){
        var bodyHeight = document.documentElement.clientHeight;
        var bodyWidth = document.documentElement.clientWidth;

        $("#wrapper").css({
                "width" : (bodyWidth ) + "px",
                "height" : (bodyHeight ) + "px",
            })

        var videoWidth = bodyWidth;
        var videoHeight = bodyWidth * 1920/ 1080;
        var top = ( bodyHeight - videoHeight )/ 2;

        $("#video").css({
                "top" : (top) + "px",
                "width" : (videoWidth ) + "px",
                "height" : (videoHeight ) + "px",
            })

        var startWidth = 200;
        var startHeight = startWidth * 73/ 238;
        var startTop = (bodyHeight - startHeight )/ 2;
        var startLeft = (bodyWidth - startWidth )/ 2;
        $("#start").css({
                "top" : (startTop) + "px",
                "left" : (startLeft) + "px",
                "width" : (startWidth ) + "px",
                "height" : (startHeight ) + "px",
            })

        $("#next").css({
                "bottom" :  "15px",
                "right" : "0px",
                "width" : (startWidth ) + "px",
                "height" : (startHeight ) + "px",
            })
   }

   function loadListener(){
        var myVideo = document.getElementById("video")

        myVideo.addEventListener('touchstart', this.onTouchEvent.bind(this), false);
        myVideo.addEventListener('touchmove', this.onTouchEvent.bind(this), false);
        myVideo.addEventListener('touchend', this.onTouchEvent.bind(this), false);

        //监听播放开始
        myVideo.addEventListener('play',function(){
            console.log("开始播放");
        });
 
        //监听播放结束
        myVideo.addEventListener('pause',function(){
            console.log("播放暂停");
        });
 
        //监听播放结束
        myVideo.addEventListener('ended',function(){
            console.log("播放结束");
            hide('video')
            isPlay = false;
            count = 0;
            show('next')
        });

        myVideo.addEventListener("timeupdate",function(){
            var timeDisplay = myVideo.currentTime;
            console.log("play time : " + myVideo.currentTime + " index : " + questionPauseIndex)
            if(timeDisplay >= questionPausePoit[questionPauseIndex]){
                myVideo.pause();
                isPlay = false;
            }
        },false);
    }

    function onTouchEvent(event){
        var event = event || window.event;
        switch (event.type) {
                case "touchstart":
                    console.log("touch start")
                    break;
                case "touchend":
                    console.log("touch end")
                    this.handleQuestion(event.changedTouches[0].clientX,event.changedTouches[0].clientY);
                    break;
                case "touchmove":
                    console.log("touch move")
                    break;
        }
    }

    function handleQuestion(x,y){
        if(isPlay){
            return
        }
        console.log("select answer x : " + x + " y : " + y);
        var bodyHeight = document.documentElement.clientHeight;
        if(questionPauseIndex == 0){
            var top = 0;
            if(y > 217 && y < 303){
                top = bodyHeight * 0.339;
                questionAnswer[0] = 1;
            }else if(y > 322 && y < 414){
                top = bodyHeight * 0.5031;
                questionAnswer[0] = 2;
            }else if( y > 429 && y < 512){
                top = bodyHeight * 0.6703;
                questionAnswer[0] = 3;
            }
            this.removeAnswerSelect('answer_id')
            show("next")
            addAnswerSelect(top);
        }else if(questionPauseIndex == 1){
            var top = 0;
            if(y > 217 && y < 303){
                top = bodyHeight * 0.339;
                questionAnswer[0] = 1;
            }else if(y > 322 && y < 414){
                top = bodyHeight * 0.5031;
                questionAnswer[0] = 2;
            }
            this.removeAnswerSelect('answer_id')
            show("next")
            addAnswerSelect(top);
        }
    }

    function startPlay(){
        this.hide("start")
        this.show("video")
        var myVideo = document.getElementById("video")
        myVideo.play()
        isPlay = true;
        questionPauseIndex ++;
        // myVideo.currentTime=178;
    }

    function addAnswerSelect(top){
        var bodyWidth = document.documentElement.clientWidth;
        var bodyHeight = document.documentElement.clientHeight;

        var parentDiv = document.getElementById("wrapper");
        var answerDiv = document.createElement("div");
        var styleDes = "position:" + "absolute;";
        styleDes += ("width:" + (bodyWidth - 10) + 'px;');
        styleDes += ("height:" + (bodyHeight * 0.1345728) + 'px;');
        styleDes += ("border:2px dashed #FFFFFF;");
        styleDes += ("left:3px;");
        styleDes += ("top:" + top+ "px;");
        answerDiv.setAttribute('style', styleDes);
        answerDiv.setAttribute('class', "answer_div");
        answerDiv.setAttribute('id', "answer_id");
        parentDiv.appendChild(answerDiv);  
    }

    function removeAnswerSelect(idName){
        var div = document.getElementById(idName);
        if(div){
            div.parentNode.removeChild(div);
        }
    }

    function answerNext(){
        var myVideo = document.getElementById("video")
        if(questionPauseIndex == 0){
            myVideo.play()
            isPlay =  true;
            questionPauseIndex ++ ;
            this.removeAnswerSelect('answer_id')
            hide("next")
            if(questionAnswer[0] == 2){
            }
        }else if(questionPauseIndex == 1){
            if(questionAnswer[0] == 1){
            }else{
                myVideo.currentTime=190.9;
            }
            myVideo.play()
            isPlay =  true;
            questionPauseIndex ++ ;
            this.removeAnswerSelect('answer_id')
            hide("next")
        }
    }

    function hide(tagId){
        document.getElementById(tagId).style.display = "none"
    }

    function show(tagId){
        document.getElementById(tagId).style.display = "block"
    }

</script>

</html>
